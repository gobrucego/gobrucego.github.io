<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <title>4å¤©ï¼šTCP/IPå››å±‚æ¨¡å‹</title>
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 8.1.0"></head>
  <body>
    <main class="container">
      <header class="header">
    <div class="blog-title">
        <h1><a href="/">Zen</a></h1>
        <p class="description"></p>
    </div>
    <nav class="navbar">
        <ul class="menu">
            
            <li class="menu-item">
                <a href="/" class="menu-item-link">writing</a>
            </li>
            
            <li class="menu-item">
                <a href="/about" class="menu-item-link">who am I?</a>
            </li>
            
        </ul>
    </nav>
</header>

      <article class="post">
          <div class="post-title">
            <h2 class="title">4å¤©ï¼šTCP/IPå››å±‚æ¨¡å‹</h2>
          </div>          
          <div class="post-meta">
            <span class="post-time">2025-11-10</span>
            
            
    <div class="article-tag">
        <p> TAGS: <a class="tag-link-link" href="/tags/Network-Book-Python/" rel="tag">Network, Book, Python</a> </p>
    </div>

            <hr>
          </div>
          <div class="post-content"><h1 id="ç¬¬4å¤©ï¼šTCP-IPå››å±‚æ¨¡å‹"><a href="#ç¬¬4å¤©ï¼šTCP-IPå››å±‚æ¨¡å‹" class="headerlink" title="ç¬¬4å¤©ï¼šTCP&#x2F;IPå››å±‚æ¨¡å‹"></a>ç¬¬4å¤©ï¼šTCP&#x2F;IPå››å±‚æ¨¡å‹</h1><blockquote>
<p>â€œç†è®ºæ˜¯OSIï¼Œå®æˆ˜æ˜¯TCP&#x2F;IPã€‚â€</p>
</blockquote>
<h2 id="ğŸ“š-ä»Šæ—¥ç›®æ ‡"><a href="#ğŸ“š-ä»Šæ—¥ç›®æ ‡" class="headerlink" title="ğŸ“š ä»Šæ—¥ç›®æ ‡"></a>ğŸ“š ä»Šæ—¥ç›®æ ‡</h2><ul>
<li>ç†è§£TCP&#x2F;IPå››å±‚æ¨¡å‹</li>
<li>æŒæ¡TCP&#x2F;IPä¸OSIçš„åŒºåˆ«å’Œè”ç³»</li>
<li>å­¦ä¼šåˆ†æçœŸå®çš„ç½‘ç»œæ•°æ®åŒ…</li>
<li>ç¼–å†™ç¨‹åºæ•è·å’Œè§£ææ•°æ®åŒ…</li>
</ul>
<h2 id="ğŸ¯-ä¸ºä»€ä¹ˆéœ€è¦TCP-IPæ¨¡å‹ï¼Ÿ"><a href="#ğŸ¯-ä¸ºä»€ä¹ˆéœ€è¦TCP-IPæ¨¡å‹ï¼Ÿ" class="headerlink" title="ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦TCP&#x2F;IPæ¨¡å‹ï¼Ÿ"></a>ğŸ¯ ä¸ºä»€ä¹ˆéœ€è¦TCP&#x2F;IPæ¨¡å‹ï¼Ÿ</h2><h3 id="OSI-vs-TCP-IP"><a href="#OSI-vs-TCP-IP" class="headerlink" title="OSI vs TCP&#x2F;IP"></a>OSI vs TCP&#x2F;IP</h3><p><strong>OSIä¸ƒå±‚æ¨¡å‹</strong>ï¼š</p>
<ul>
<li>ğŸ“– ç†è®ºæ¨¡å‹ï¼Œç”±ISOåˆ¶å®š</li>
<li>ğŸ“ æ•™å­¦ç”¨é€”ï¼Œå¸®åŠ©ç†è§£ç½‘ç»œæ¦‚å¿µ</li>
<li>ğŸ“š è¿‡äºå¤æ‚ï¼Œå®é™…åº”ç”¨è¾ƒå°‘</li>
</ul>
<p><strong>TCP&#x2F;IPå››å±‚æ¨¡å‹</strong>ï¼š</p>
<ul>
<li>ğŸ’» å®é™…ä½¿ç”¨çš„æ¨¡å‹</li>
<li>ğŸŒ äº’è”ç½‘çš„åŸºç¡€</li>
<li>ğŸš€ ç®€å•å®ç”¨ï¼Œå¹¿æ³›åº”ç”¨</li>
</ul>
<h3 id="ç±»æ¯”ç†è§£"><a href="#ç±»æ¯”ç†è§£" class="headerlink" title="ç±»æ¯”ç†è§£"></a>ç±»æ¯”ç†è§£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OSIæ¨¡å‹ = ç†æƒ³çš„å»ºç­‘è®¾è®¡å›¾çº¸ï¼ˆ7å±‚æ¥¼ï¼‰</span><br><span class="line">TCP/IPæ¨¡å‹ = å®é™…å»ºé€ çš„æˆ¿å­ï¼ˆ4å±‚æ¥¼ï¼Œä½†åŠŸèƒ½é½å…¨ï¼‰</span><br></pre></td></tr></table></figure>

<h2 id="ğŸ“Š-TCP-IPå››å±‚æ¨¡å‹"><a href="#ğŸ“Š-TCP-IPå››å±‚æ¨¡å‹" class="headerlink" title="ğŸ“Š TCP&#x2F;IPå››å±‚æ¨¡å‹"></a>ğŸ“Š TCP&#x2F;IPå››å±‚æ¨¡å‹</h2><h3 id="å±‚æ¬¡å¯¹åº”å…³ç³»"><a href="#å±‚æ¬¡å¯¹åº”å…³ç³»" class="headerlink" title="å±‚æ¬¡å¯¹åº”å…³ç³»"></a>å±‚æ¬¡å¯¹åº”å…³ç³»</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   OSIä¸ƒå±‚æ¨¡å‹    â”‚            TCP/IPå››å±‚æ¨¡å‹</span><br><span class="line">â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤</span><br><span class="line">â”‚  7. åº”ç”¨å±‚       â”‚ \</span><br><span class="line">â”‚  6. è¡¨ç¤ºå±‚       â”‚  \       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚  5. ä¼šè¯å±‚       â”‚   &#125; â”€â”€â”€&gt; â”‚  4. åº”ç”¨å±‚       â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  /       â”‚  (Application)   â”‚</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” /        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">â”‚  4. ä¼ è¾“å±‚       â”‚ â”€â”€â”€â”€â”€â”€â”€&gt; â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  3. ä¼ è¾“å±‚       â”‚</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  (Transport)     â”‚</span><br><span class="line">â”‚  3. ç½‘ç»œå±‚       â”‚ â”€â”€â”€â”€â”€â”€â”€&gt; â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  2. ç½‘é™…å±‚       â”‚</span><br><span class="line">â”‚  2. æ•°æ®é“¾è·¯å±‚   â”‚ \        â”‚  (Internet)      â”‚</span><br><span class="line">â”‚  1. ç‰©ç†å±‚       â”‚  &#125; â”€â”€â”€&gt;  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ /        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">                               â”‚  1. ç½‘ç»œæ¥å£å±‚   â”‚</span><br><span class="line">                               â”‚  (Network Access)â”‚</span><br><span class="line">                               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h3 id="TCP-IPå„å±‚è¯¦è§£"><a href="#TCP-IPå„å±‚è¯¦è§£" class="headerlink" title="TCP&#x2F;IPå„å±‚è¯¦è§£"></a>TCP&#x2F;IPå„å±‚è¯¦è§£</h3><h4 id="ç¬¬4å±‚ï¼šåº”ç”¨å±‚ï¼ˆApplication-Layerï¼‰"><a href="#ç¬¬4å±‚ï¼šåº”ç”¨å±‚ï¼ˆApplication-Layerï¼‰" class="headerlink" title="ç¬¬4å±‚ï¼šåº”ç”¨å±‚ï¼ˆApplication Layerï¼‰"></a>ç¬¬4å±‚ï¼šåº”ç”¨å±‚ï¼ˆApplication Layerï¼‰</h4><p><strong>å¯¹åº”OSI</strong>ï¼šåº”ç”¨å±‚ + è¡¨ç¤ºå±‚ + ä¼šè¯å±‚</p>
<p><strong>ä¸»è¦åè®®</strong>ï¼š</p>
<ul>
<li>ğŸŒ HTTP&#x2F;HTTPSï¼šç½‘é¡µæµè§ˆ</li>
<li>ğŸ“§ SMTP&#x2F;POP3&#x2F;IMAPï¼šé‚®ä»¶</li>
<li>ğŸ“ FTPï¼šæ–‡ä»¶ä¼ è¾“</li>
<li>ğŸ” DNSï¼šåŸŸåè§£æ</li>
<li>ğŸ” SSHï¼šè¿œç¨‹ç™»å½•</li>
<li>ğŸ’¬ MQTTï¼šç‰©è”ç½‘é€šä¿¡</li>
</ul>
<p><strong>ä½œç”¨</strong>ï¼šä¸ºç”¨æˆ·æä¾›å„ç§ç½‘ç»œæœåŠ¡</p>
<p><strong>ä¾‹å­</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">æµè§ˆå™¨è®¿é—® www.baidu.com</span><br><span class="line">â†“</span><br><span class="line">åº”ç”¨å±‚ï¼šç”ŸæˆHTTPè¯·æ±‚</span><br><span class="line">GET / HTTP/1.1</span><br><span class="line">Host: www.baidu.com</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="ç¬¬3å±‚ï¼šä¼ è¾“å±‚ï¼ˆTransport-Layerï¼‰"><a href="#ç¬¬3å±‚ï¼šä¼ è¾“å±‚ï¼ˆTransport-Layerï¼‰" class="headerlink" title="ç¬¬3å±‚ï¼šä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰"></a>ç¬¬3å±‚ï¼šä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰</h4><p><strong>å¯¹åº”OSI</strong>ï¼šä¼ è¾“å±‚</p>
<p><strong>ä¸»è¦åè®®</strong>ï¼š</p>
<ul>
<li>ğŸšš TCPï¼šå¯é ä¼ è¾“ï¼Œé¢å‘è¿æ¥</li>
<li>ğŸ“¦ UDPï¼šå¿«é€Ÿä¼ è¾“ï¼Œæ— è¿æ¥</li>
</ul>
<p><strong>ä½œç”¨</strong>ï¼šæä¾›ç«¯åˆ°ç«¯çš„æ•°æ®ä¼ è¾“</p>
<p><strong>å…³é”®æ¦‚å¿µ</strong>ï¼š</p>
<ul>
<li><strong>ç«¯å£å·</strong>ï¼šæ ‡è¯†åº”ç”¨ç¨‹åº<ul>
<li>HTTP: 80</li>
<li>HTTPS: 443</li>
<li>SSH: 22</li>
<li>MySQL: 3306</li>
</ul>
</li>
</ul>
<p><strong>TCP vs UDP</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">TCP = æ‰“ç”µè¯ï¼ˆéœ€è¦æ¥é€šï¼Œå¯é ï¼‰</span><br><span class="line">UDP = å‘çŸ­ä¿¡ï¼ˆç›´æ¥å‘ï¼Œä¸ä¿è¯é€è¾¾ï¼‰</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="ç¬¬2å±‚ï¼šç½‘é™…å±‚ï¼ˆInternet-Layerï¼‰"><a href="#ç¬¬2å±‚ï¼šç½‘é™…å±‚ï¼ˆInternet-Layerï¼‰" class="headerlink" title="ç¬¬2å±‚ï¼šç½‘é™…å±‚ï¼ˆInternet Layerï¼‰"></a>ç¬¬2å±‚ï¼šç½‘é™…å±‚ï¼ˆInternet Layerï¼‰</h4><p><strong>å¯¹åº”OSI</strong>ï¼šç½‘ç»œå±‚</p>
<p><strong>ä¸»è¦åè®®</strong>ï¼š</p>
<ul>
<li>ğŸŒ IPï¼šç½‘é™…åè®®ï¼ˆIPv4&#x2F;IPv6ï¼‰</li>
<li>ğŸ“¡ ICMPï¼šæ§åˆ¶æ¶ˆæ¯åè®®</li>
<li>ğŸ—ºï¸ ARPï¼šåœ°å€è§£æåè®®</li>
<li>ğŸ”€ IGMPï¼šç»„ç®¡ç†åè®®</li>
</ul>
<p><strong>ä½œç”¨</strong>ï¼šè·¯ç”±å’Œå¯»å€ï¼Œåœ¨ç½‘ç»œé—´ä¼ è¾“æ•°æ®</p>
<p><strong>å…³é”®æ¦‚å¿µ</strong>ï¼š</p>
<ul>
<li><strong>IPåœ°å€</strong>ï¼šè®¾å¤‡çš„ç½‘ç»œåœ°å€<ul>
<li>192.168.1.100ï¼ˆç§ç½‘ï¼‰</li>
<li>8.8.8.8ï¼ˆå…¬ç½‘ï¼‰</li>
</ul>
</li>
</ul>
<p><strong>ä¾‹å­</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ä»åŒ—äº¬çš„ç”µè„‘è®¿é—®ä¸Šæµ·çš„æœåŠ¡å™¨</span><br><span class="line">â†“</span><br><span class="line">ç½‘é™…å±‚ï¼šé€‰æ‹©æœ€ä½³è·¯å¾„</span><br><span class="line">åŒ—äº¬ â†’ è·¯ç”±å™¨1 â†’ è·¯ç”±å™¨2 â†’ ... â†’ ä¸Šæµ·</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="ç¬¬1å±‚ï¼šç½‘ç»œæ¥å£å±‚ï¼ˆNetwork-Access-Layerï¼‰"><a href="#ç¬¬1å±‚ï¼šç½‘ç»œæ¥å£å±‚ï¼ˆNetwork-Access-Layerï¼‰" class="headerlink" title="ç¬¬1å±‚ï¼šç½‘ç»œæ¥å£å±‚ï¼ˆNetwork Access Layerï¼‰"></a>ç¬¬1å±‚ï¼šç½‘ç»œæ¥å£å±‚ï¼ˆNetwork Access Layerï¼‰</h4><p><strong>å¯¹åº”OSI</strong>ï¼šæ•°æ®é“¾è·¯å±‚ + ç‰©ç†å±‚</p>
<p><strong>ä¸»è¦åè®®</strong>ï¼š</p>
<ul>
<li>ğŸ”— Ethernetï¼šä»¥å¤ªç½‘</li>
<li>ğŸ“¶ WiFiï¼šæ— çº¿å±€åŸŸç½‘</li>
<li>ğŸ”Œ PPPï¼šç‚¹å¯¹ç‚¹åè®®</li>
</ul>
<p><strong>ä½œç”¨</strong>ï¼šåœ¨ç‰©ç†ç½‘ç»œä¸Šä¼ è¾“æ•°æ®å¸§</p>
<p><strong>å…³é”®æ¦‚å¿µ</strong>ï¼š</p>
<ul>
<li><strong>MACåœ°å€</strong>ï¼šç½‘å¡çš„ç‰©ç†åœ°å€<ul>
<li>AA:BB:CC:DD:EE:FF</li>
</ul>
</li>
</ul>
<p><strong>ä¾‹å­</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŒä¸€ä¸ªå±€åŸŸç½‘å†…çš„ä¸¤å°ç”µè„‘é€šä¿¡</span><br><span class="line">â†“</span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼šé€šè¿‡MACåœ°å€ç›´æ¥ä¼ è¾“</span><br><span class="line">ç”µè„‘Açš„ç½‘å¡ â†’ äº¤æ¢æœº â†’ ç”µè„‘Bçš„ç½‘å¡</span><br></pre></td></tr></table></figure>

<h2 id="ğŸ“¦-TCP-IPæ•°æ®å°è£…"><a href="#ğŸ“¦-TCP-IPæ•°æ®å°è£…" class="headerlink" title="ğŸ“¦ TCP&#x2F;IPæ•°æ®å°è£…"></a>ğŸ“¦ TCP&#x2F;IPæ•°æ®å°è£…</h2><h3 id="å‘é€æ•°æ®çš„å°è£…è¿‡ç¨‹"><a href="#å‘é€æ•°æ®çš„å°è£…è¿‡ç¨‹" class="headerlink" title="å‘é€æ•°æ®çš„å°è£…è¿‡ç¨‹"></a>å‘é€æ•°æ®çš„å°è£…è¿‡ç¨‹</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼š</span><br><span class="line">[HTTPè¯·æ±‚æ•°æ®]</span><br><span class="line">    â†“</span><br><span class="line">ä¼ è¾“å±‚ï¼š</span><br><span class="line">[TCPå¤´éƒ¨ | HTTPè¯·æ±‚æ•°æ®]  â† Segmentï¼ˆæ®µï¼‰</span><br><span class="line">    â†“</span><br><span class="line">ç½‘é™…å±‚ï¼š</span><br><span class="line">[IPå¤´éƒ¨ | TCPå¤´éƒ¨ | HTTPè¯·æ±‚æ•°æ®]  â† Packetï¼ˆåŒ…ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼š</span><br><span class="line">[ä»¥å¤ªç½‘å¸§å¤´ | IPå¤´éƒ¨ | TCPå¤´éƒ¨ | HTTPè¯·æ±‚æ•°æ® | å¸§å°¾]  â† Frameï¼ˆå¸§ï¼‰</span><br><span class="line">    â†“</span><br><span class="line">ç‰©ç†å±‚ï¼š</span><br><span class="line">01010101...  â† Bitsï¼ˆæ¯”ç‰¹æµï¼‰</span><br></pre></td></tr></table></figure>

<h3 id="å„å±‚æ·»åŠ çš„ä¿¡æ¯"><a href="#å„å±‚æ·»åŠ çš„ä¿¡æ¯" class="headerlink" title="å„å±‚æ·»åŠ çš„ä¿¡æ¯"></a>å„å±‚æ·»åŠ çš„ä¿¡æ¯</h3><table>
<thead>
<tr>
<th>å±‚æ¬¡</th>
<th>æ·»åŠ çš„ä¿¡æ¯</th>
<th>ç›®çš„</th>
</tr>
</thead>
<tbody><tr>
<td>åº”ç”¨å±‚</td>
<td>åº”ç”¨æ•°æ®</td>
<td>ç”¨æˆ·æ•°æ®</td>
</tr>
<tr>
<td>ä¼ è¾“å±‚</td>
<td>æºç«¯å£ã€ç›®æ ‡ç«¯å£</td>
<td>æ ‡è¯†åº”ç”¨ç¨‹åº</td>
</tr>
<tr>
<td>ç½‘é™…å±‚</td>
<td>æºIPã€ç›®æ ‡IP</td>
<td>æ ‡è¯†ä¸»æœºä½ç½®</td>
</tr>
<tr>
<td>ç½‘ç»œæ¥å£å±‚</td>
<td>æºMACã€ç›®æ ‡MAC</td>
<td>æ ‡è¯†ç½‘å¡</td>
</tr>
</tbody></table>
<h2 id="ğŸ”§-å®æˆ˜é¡¹ç›®ï¼šæ•°æ®åŒ…åˆ†æå™¨"><a href="#ğŸ”§-å®æˆ˜é¡¹ç›®ï¼šæ•°æ®åŒ…åˆ†æå™¨" class="headerlink" title="ğŸ”§ å®æˆ˜é¡¹ç›®ï¼šæ•°æ®åŒ…åˆ†æå™¨"></a>ğŸ”§ å®æˆ˜é¡¹ç›®ï¼šæ•°æ®åŒ…åˆ†æå™¨</h2><p>è®©æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªç¨‹åºï¼Œæ•è·å’Œåˆ†æçœŸå®çš„ç½‘ç»œæ•°æ®åŒ…ï¼</p>
<h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># day04_packet_analyzer.py</span></span><br><span class="line"><span class="comment"># åŠŸèƒ½ï¼šæ•è·å¹¶åˆ†æç½‘ç»œæ•°æ®åŒ…ï¼ˆTCP/IPå„å±‚ä¿¡æ¯ï¼‰</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> textwrap</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ethernet_frame</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£æä»¥å¤ªç½‘å¸§ï¼ˆç½‘ç»œæ¥å£å±‚ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    ä»¥å¤ªç½‘å¸§æ ¼å¼ï¼š</span></span><br><span class="line"><span class="string">    [ç›®æ ‡MAC(6å­—èŠ‚) | æºMAC(6å­—èŠ‚) | ç±»å‹(2å­—èŠ‚) | æ•°æ® | CRC(4å­—èŠ‚)]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># æå–MACåœ°å€å’Œç±»å‹</span></span><br><span class="line">    dest_mac, src_mac, eth_type = struct.unpack(<span class="string">&#x27;! 6s 6s H&#x27;</span>, data[:<span class="number">14</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¼å¼åŒ–MACåœ°å€</span></span><br><span class="line">    dest_mac = <span class="string">&#x27;:&#x27;</span>.join(<span class="string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> dest_mac)</span><br><span class="line">    src_mac = <span class="string">&#x27;:&#x27;</span>.join(<span class="string">&#x27;&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(b) <span class="keyword">for</span> b <span class="keyword">in</span> src_mac)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># ä»¥å¤ªç½‘ç±»å‹</span></span><br><span class="line">    <span class="comment"># 0x0800 = IPv4, 0x86DD = IPv6, 0x0806 = ARP</span></span><br><span class="line">    eth_type = socket.htons(eth_type)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è¿”å›MACåœ°å€ã€ç±»å‹å’Œå‰©ä½™æ•°æ®</span></span><br><span class="line">    <span class="keyword">return</span> dest_mac, src_mac, eth_type, data[<span class="number">14</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ipv4_packet</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£æIPv4æ•°æ®åŒ…ï¼ˆç½‘é™…å±‚ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    IPv4å¤´éƒ¨æ ¼å¼ï¼ˆ20å­—èŠ‚ï¼‰ï¼š</span></span><br><span class="line"><span class="string">    [ç‰ˆæœ¬+å¤´é•¿(1) | æœåŠ¡ç±»å‹(1) | æ€»é•¿åº¦(2) | æ ‡è¯†(2) | æ ‡å¿—+åç§»(2) |</span></span><br><span class="line"><span class="string">     TTL(1) | åè®®(1) | æ ¡éªŒå’Œ(2) | æºIP(4) | ç›®æ ‡IP(4)]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="comment"># è§£æIPv4å¤´éƒ¨çš„å‰20å­—èŠ‚</span></span><br><span class="line">    version_header_length = data[<span class="number">0</span>]</span><br><span class="line">    version = version_header_length &gt;&gt; <span class="number">4</span>  <span class="comment"># é«˜4ä½æ˜¯ç‰ˆæœ¬</span></span><br><span class="line">    header_length = (version_header_length &amp; <span class="number">15</span>) * <span class="number">4</span>  <span class="comment"># ä½4ä½æ˜¯å¤´é•¿ï¼ˆå•ä½ï¼š4å­—èŠ‚ï¼‰</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–TTLã€åè®®ã€æºIPã€ç›®æ ‡IP</span></span><br><span class="line">    ttl, proto, src, target = struct.unpack(<span class="string">&#x27;! 8x B B 2x 4s 4s&#x27;</span>, data[:<span class="number">20</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ ¼å¼åŒ–IPåœ°å€</span></span><br><span class="line">    src_ip = <span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, src))</span><br><span class="line">    target_ip = <span class="string">&#x27;.&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, target))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åè®®å·å¯¹åº”çš„åè®®å</span></span><br><span class="line">    protocols = &#123;<span class="number">1</span>: <span class="string">&#x27;ICMP&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;TCP&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;UDP&#x27;</span>&#125;</span><br><span class="line">    proto_name = protocols.get(proto, <span class="string">f&#x27;Other(<span class="subst">&#123;proto&#125;</span>)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> version, header_length, ttl, proto_name, src_ip, target_ip, data[header_length:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tcp_segment</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£æTCPæ®µï¼ˆä¼ è¾“å±‚ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    TCPå¤´éƒ¨æ ¼å¼ï¼ˆè‡³å°‘20å­—èŠ‚ï¼‰ï¼š</span></span><br><span class="line"><span class="string">    [æºç«¯å£(2) | ç›®æ ‡ç«¯å£(2) | åºå·(4) | ç¡®è®¤å·(4) |</span></span><br><span class="line"><span class="string">     å¤´é•¿+æ ‡å¿—(2) | çª—å£(2) | æ ¡éªŒå’Œ(2) | ç´§æ€¥æŒ‡é’ˆ(2)]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    src_port, dest_port, sequence, acknowledgment, offset_reserved_flags = struct.unpack(</span><br><span class="line">        <span class="string">&#x27;! H H L L H&#x27;</span>, data[:<span class="number">14</span>]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–å¤´éƒ¨é•¿åº¦ï¼ˆé«˜4ä½ï¼‰</span></span><br><span class="line">    offset = (offset_reserved_flags &gt;&gt; <span class="number">12</span>) * <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># æå–TCPæ ‡å¿—ä½</span></span><br><span class="line">    flag_urg = (offset_reserved_flags &amp; <span class="number">32</span>) &gt;&gt; <span class="number">5</span></span><br><span class="line">    flag_ack = (offset_reserved_flags &amp; <span class="number">16</span>) &gt;&gt; <span class="number">4</span></span><br><span class="line">    flag_psh = (offset_reserved_flags &amp; <span class="number">8</span>) &gt;&gt; <span class="number">3</span></span><br><span class="line">    flag_rst = (offset_reserved_flags &amp; <span class="number">4</span>) &gt;&gt; <span class="number">2</span></span><br><span class="line">    flag_syn = (offset_reserved_flags &amp; <span class="number">2</span>) &gt;&gt; <span class="number">1</span></span><br><span class="line">    flag_fin = offset_reserved_flags &amp; <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> src_port, dest_port, sequence, acknowledgment, flag_urg, flag_ack, \</span><br><span class="line">           flag_psh, flag_rst, flag_syn, flag_fin, data[offset:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">udp_segment</span>(<span class="params">data</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    è§£æUDPæ®µï¼ˆä¼ è¾“å±‚ï¼‰</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    UDPå¤´éƒ¨æ ¼å¼ï¼ˆ8å­—èŠ‚ï¼‰ï¼š</span></span><br><span class="line"><span class="string">    [æºç«¯å£(2) | ç›®æ ‡ç«¯å£(2) | é•¿åº¦(2) | æ ¡éªŒå’Œ(2)]</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    src_port, dest_port, length = struct.unpack(<span class="string">&#x27;! H H 2x H&#x27;</span>, data[:<span class="number">8</span>])</span><br><span class="line">    <span class="keyword">return</span> src_port, dest_port, length, data[<span class="number">8</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">format_multi_line</span>(<span class="params">prefix, string, size=<span class="number">80</span></span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;æ ¼å¼åŒ–å¤šè¡Œè¾“å‡º&quot;&quot;&quot;</span></span><br><span class="line">    size -= <span class="built_in">len</span>(prefix)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">isinstance</span>(string, <span class="built_in">bytes</span>):</span><br><span class="line">        string = <span class="string">&#x27;&#x27;</span>.join(<span class="string">r&#x27;\x&#123;:02x&#125;&#x27;</span>.<span class="built_in">format</span>(byte) <span class="keyword">for</span> byte <span class="keyword">in</span> string)</span><br><span class="line">        <span class="keyword">if</span> size % <span class="number">2</span>:</span><br><span class="line">            size -= <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;\n&#x27;</span>.join([prefix + line <span class="keyword">for</span> line <span class="keyword">in</span> textwrap.wrap(string, size)])</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    ä¸»å‡½æ•°ï¼šæ•è·å¹¶åˆ†ææ•°æ®åŒ…</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">80</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;TCP/IPæ•°æ®åŒ…åˆ†æå™¨&quot;</span>.center(<span class="number">80</span>))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">80</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;\nğŸ“¡ æ­£åœ¨ç›‘å¬ç½‘ç»œæ¥å£...&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ğŸ’¡ æç¤ºï¼šè®¿é—®ä¸€ä¸ªç½‘ç«™æˆ–pingä¸€ä¸ªåœ°å€æ¥ç”Ÿæˆæµé‡&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;âš ï¸  æŒ‰Ctrl+Cåœæ­¢æ•è·\n&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># åˆ›å»ºåŸå§‹å¥—æ¥å­—</span></span><br><span class="line">    <span class="comment"># æ³¨æ„ï¼šåœ¨æŸäº›ç³»ç»Ÿä¸Šå¯èƒ½éœ€è¦rootæƒé™</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># Windows</span></span><br><span class="line">        conn = socket.socket(socket.AF_INET, socket.SOCK_RAW, socket.IPPROTO_IP)</span><br><span class="line">        conn.bind((<span class="string">&#x27;&#x27;</span>, <span class="number">0</span>))</span><br><span class="line">        conn.setsockopt(socket.IPPROTO_IP, socket.IP_HDRINCL, <span class="number">1</span>)</span><br><span class="line">        conn.ioctl(socket.SIO_RCVALL, socket.RCVALL_ON)</span><br><span class="line">    <span class="keyword">except</span> AttributeError:</span><br><span class="line">        <span class="comment"># Linux/Mac</span></span><br><span class="line">        conn = socket.socket(socket.AF_PACKET, socket.SOCK_RAW, socket.ntohs(<span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">    packet_count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># æ¥æ”¶æ•°æ®</span></span><br><span class="line">            raw_data, addr = conn.recvfrom(<span class="number">65535</span>)</span><br><span class="line">            packet_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;\n<span class="subst">&#123;<span class="string">&#x27;â–¼&#x27;</span> * <span class="number">40</span>&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“¦ æ•°æ®åŒ… #<span class="subst">&#123;packet_count&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="string">&#x27;â–¼&#x27;</span> * <span class="number">40</span>&#125;</span>\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 1. è§£æä»¥å¤ªç½‘å¸§ï¼ˆç½‘ç»œæ¥å£å±‚ï¼‰</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                dest_mac, src_mac, eth_type, data = ethernet_frame(raw_data)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;ğŸ”— ç½‘ç»œæ¥å£å±‚ï¼ˆä»¥å¤ªç½‘å¸§ï¼‰&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   æºMACåœ°å€: <span class="subst">&#123;src_mac&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   ç›®æ ‡MACåœ°å€: <span class="subst">&#123;dest_mac&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åè®®ç±»å‹: 0x<span class="subst">&#123;eth_type:04x&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                <span class="comment"># æŸäº›ç³»ç»Ÿå¯èƒ½ä¸åŒ…å«ä»¥å¤ªç½‘å¤´</span></span><br><span class="line">                eth_type = <span class="number">0x0800</span></span><br><span class="line">                data = raw_data</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 2. è§£æIPæ•°æ®åŒ…ï¼ˆç½‘é™…å±‚ï¼‰</span></span><br><span class="line">            <span class="keyword">if</span> eth_type == <span class="number">0x0800</span>:  <span class="comment"># IPv4</span></span><br><span class="line">                version, header_length, ttl, proto, src_ip, target_ip, data = ipv4_packet(data)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nğŸŒ ç½‘é™…å±‚ï¼ˆIPæ•°æ®åŒ…ï¼‰&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   IPç‰ˆæœ¬: IPv<span class="subst">&#123;version&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   å¤´éƒ¨é•¿åº¦: <span class="subst">&#123;header_length&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   TTL: <span class="subst">&#123;ttl&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   åè®®: <span class="subst">&#123;proto&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   æºIPåœ°å€: <span class="subst">&#123;src_ip&#125;</span>&quot;</span>)</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;   ç›®æ ‡IPåœ°å€: <span class="subst">&#123;target_ip&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="comment"># 3. è§£æä¼ è¾“å±‚</span></span><br><span class="line">                <span class="keyword">if</span> proto == <span class="string">&#x27;TCP&#x27;</span>:</span><br><span class="line">                    src_port, dest_port, sequence, acknowledgment, flag_urg, flag_ack, \</span><br><span class="line">                    flag_psh, flag_rst, flag_syn, flag_fin, data = tcp_segment(data)</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸšš ä¼ è¾“å±‚ï¼ˆTCPæ®µï¼‰&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   æºç«¯å£: <span class="subst">&#123;src_port&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   ç›®æ ‡ç«¯å£: <span class="subst">&#123;dest_port&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   åºåˆ—å·: <span class="subst">&#123;sequence&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   ç¡®è®¤å·: <span class="subst">&#123;acknowledgment&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   æ ‡å¿—ä½: &quot;</span>, end=<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    flags = []</span><br><span class="line">                    <span class="keyword">if</span> flag_syn: flags.append(<span class="string">&quot;SYN&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_ack: flags.append(<span class="string">&quot;ACK&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_fin: flags.append(<span class="string">&quot;FIN&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_rst: flags.append(<span class="string">&quot;RST&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_psh: flags.append(<span class="string">&quot;PSH&quot;</span>)</span><br><span class="line">                    <span class="keyword">if</span> flag_urg: flags.append(<span class="string">&quot;URG&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">&quot;, &quot;</span>.join(flags) <span class="keyword">if</span> flags <span class="keyword">else</span> <span class="string">&quot;æ— &quot;</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># 4. åº”ç”¨å±‚æ•°æ®</span></span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">len</span>(data) &gt; <span class="number">0</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“± åº”ç”¨å±‚æ•°æ®&quot;</span>)</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;   æ•°æ®é•¿åº¦: <span class="subst">&#123;<span class="built_in">len</span>(data)&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">                        <span class="comment"># å°è¯•è§£æHTTP</span></span><br><span class="line">                        <span class="keyword">try</span>:</span><br><span class="line">                            data_str = data.decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">                            <span class="keyword">if</span> data_str.startswith(<span class="string">&#x27;HTTP&#x27;</span>) <span class="keyword">or</span> data_str.startswith(<span class="string">&#x27;GET&#x27;</span>) <span class="keyword">or</span> \</span><br><span class="line">                               data_str.startswith(<span class="string">&#x27;POST&#x27;</span>):</span><br><span class="line">                                <span class="built_in">print</span>(<span class="string">f&quot;   åè®®: HTTP&quot;</span>)</span><br><span class="line">                                lines = data_str.split(<span class="string">&#x27;\\r\\n&#x27;</span>)[:<span class="number">5</span>]  <span class="comment"># åªæ˜¾ç¤ºå‰5è¡Œ</span></span><br><span class="line">                                <span class="keyword">for</span> line <span class="keyword">in</span> lines:</span><br><span class="line">                                    <span class="keyword">if</span> line:</span><br><span class="line">                                        <span class="built_in">print</span>(<span class="string">f&quot;   <span class="subst">&#123;line&#125;</span>&quot;</span>)</span><br><span class="line">                        <span class="keyword">except</span>:</span><br><span class="line">                            <span class="built_in">print</span>(<span class="string">f&quot;   æ•°æ®é¢„è§ˆ: <span class="subst">&#123;data[:<span class="number">50</span>]&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">elif</span> proto == <span class="string">&#x27;UDP&#x27;</span>:</span><br><span class="line">                    src_port, dest_port, length, data = udp_segment(data)</span><br><span class="line"></span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¦ ä¼ è¾“å±‚ï¼ˆUDPæ®µï¼‰&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   æºç«¯å£: <span class="subst">&#123;src_port&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   ç›®æ ‡ç«¯å£: <span class="subst">&#123;dest_port&#125;</span>&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   é•¿åº¦: <span class="subst">&#123;length&#125;</span>å­—èŠ‚&quot;</span>)</span><br><span class="line"></span><br><span class="line">                    <span class="comment"># DNSæŸ¥è¯¢/å“åº”</span></span><br><span class="line">                    <span class="keyword">if</span> src_port == <span class="number">53</span> <span class="keyword">or</span> dest_port == <span class="number">53</span>:</span><br><span class="line">                        <span class="built_in">print</span>(<span class="string">f&quot;   åº”ç”¨åè®®: DNS&quot;</span>)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">elif</span> proto == <span class="string">&#x27;ICMP&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;\nğŸ“¡ ä¼ è¾“å±‚ï¼ˆICMPï¼‰&quot;</span>)</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&quot;   è¿™æ˜¯ä¸€ä¸ªpingæˆ–tracerouteæ•°æ®åŒ…&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;\n&quot;</span> + <span class="string">&quot;=&quot;</span> * <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># åªæ•è·å‰10ä¸ªåŒ…ä½œä¸ºæ¼”ç¤º</span></span><br><span class="line">            <span class="keyword">if</span> packet_count &gt;= <span class="number">10</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;\nâœ… å·²æ•è·<span class="subst">&#123;packet_count&#125;</span>ä¸ªæ•°æ®åŒ…ï¼Œåœæ­¢ç›‘å¬&quot;</span>)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> KeyboardInterrupt:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;\n\nâœ‹ ç”¨æˆ·åœæ­¢æ•è·&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;ğŸ“Š æ€»å…±æ•è·äº† <span class="subst">&#123;packet_count&#125;</span> ä¸ªæ•°æ®åŒ…&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="comment"># Windowséœ€è¦å…³é—­æ··æ‚æ¨¡å¼</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            conn.ioctl(socket.SIO_RCVALL, socket.RCVALL_OFF)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        conn.close()</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;=&quot;</span> * <span class="number">80</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    <span class="keyword">import</span> sys</span><br><span class="line">    <span class="keyword">if</span> sys.platform == <span class="string">&#x27;win32&#x27;</span> <span class="keyword">or</span> sys.platform == <span class="string">&#x27;linux&#x27;</span> <span class="keyword">or</span> sys.platform == <span class="string">&#x27;darwin&#x27;</span>:</span><br><span class="line">        main()</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;âš ï¸  æ­¤ç¨‹åºå¯èƒ½éœ€è¦ç®¡ç†å‘˜/rootæƒé™&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ’¡ Linux/Mac: sudo python day04_packet_analyzer.py&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;ğŸ’¡ Windows: ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œ&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="è¿è¡Œè¯´æ˜"><a href="#è¿è¡Œè¯´æ˜" class="headerlink" title="è¿è¡Œè¯´æ˜"></a>è¿è¡Œè¯´æ˜</h3><p><strong>Linux&#x2F;Mac</strong>ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> python code/day04/day04_packet_analyzer.py</span><br></pre></td></tr></table></figure>

<p><strong>Windows</strong>ï¼š<br>ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œå‘½ä»¤æç¤ºç¬¦ï¼Œç„¶åï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python code\day04\day04_packet_analyzer.py</span><br></pre></td></tr></table></figure>

<h3 id="é¢„æœŸè¾“å‡º"><a href="#é¢„æœŸè¾“å‡º" class="headerlink" title="é¢„æœŸè¾“å‡º"></a>é¢„æœŸè¾“å‡º</h3><p>ç¨‹åºä¼šå®æ—¶æ˜¾ç¤ºæ•è·åˆ°çš„æ•°æ®åŒ…çš„å„å±‚ä¿¡æ¯ã€‚</p>
<h2 id="ğŸ“-çŸ¥è¯†å°ç»“"><a href="#ğŸ“-çŸ¥è¯†å°ç»“" class="headerlink" title="ğŸ“ çŸ¥è¯†å°ç»“"></a>ğŸ“ çŸ¥è¯†å°ç»“</h2><h3 id="ä»Šå¤©å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"><a href="#ä»Šå¤©å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ä»Šå¤©å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ"></a>ä»Šå¤©å­¦åˆ°äº†ä»€ä¹ˆï¼Ÿ</h3><ol>
<li>âœ… TCP&#x2F;IPå››å±‚æ¨¡å‹æ˜¯å®é™…ä½¿ç”¨çš„ç½‘ç»œæ¨¡å‹</li>
<li>âœ… TCP&#x2F;IPæ¯”OSIæ›´ç®€æ´å®ç”¨</li>
<li>âœ… æ¯ä¸€å±‚éƒ½æœ‰ç‰¹å®šçš„åè®®å’Œä½œç”¨</li>
<li>âœ… æ•°æ®åŒ…åŒ…å«å¤šå±‚çš„å¤´éƒ¨ä¿¡æ¯</li>
</ol>
<h3 id="TCP-IPå››å±‚å¯¹åº”è¡¨"><a href="#TCP-IPå››å±‚å¯¹åº”è¡¨" class="headerlink" title="TCP&#x2F;IPå››å±‚å¯¹åº”è¡¨"></a>TCP&#x2F;IPå››å±‚å¯¹åº”è¡¨</h3><table>
<thead>
<tr>
<th>TCP&#x2F;IPå±‚</th>
<th>ä¸»è¦åè®®</th>
<th>å…³é”®ä¿¡æ¯</th>
<th>è®¾å¤‡</th>
</tr>
</thead>
<tbody><tr>
<td>åº”ç”¨å±‚</td>
<td>HTTPã€DNSã€FTP</td>
<td>åº”ç”¨æ•°æ®</td>
<td>-</td>
</tr>
<tr>
<td>ä¼ è¾“å±‚</td>
<td>TCPã€UDP</td>
<td>ç«¯å£å·</td>
<td>-</td>
</tr>
<tr>
<td>ç½‘é™…å±‚</td>
<td>IPã€ICMP</td>
<td>IPåœ°å€</td>
<td>è·¯ç”±å™¨</td>
</tr>
<tr>
<td>ç½‘ç»œæ¥å£å±‚</td>
<td>Ethernetã€WiFi</td>
<td>MACåœ°å€</td>
<td>äº¤æ¢æœºã€ç½‘å¡</td>
</tr>
</tbody></table>
<h3 id="é‡è¦åè®®"><a href="#é‡è¦åè®®" class="headerlink" title="é‡è¦åè®®"></a>é‡è¦åè®®</h3><p><strong>åº”ç”¨å±‚</strong>ï¼š</p>
<ul>
<li>HTTPï¼ˆ80ï¼‰ï¼šç½‘é¡µ</li>
<li>HTTPSï¼ˆ443ï¼‰ï¼šåŠ å¯†ç½‘é¡µ</li>
<li>DNSï¼ˆ53ï¼‰ï¼šåŸŸåè§£æ</li>
<li>FTPï¼ˆ21ï¼‰ï¼šæ–‡ä»¶ä¼ è¾“</li>
<li>SSHï¼ˆ22ï¼‰ï¼šè¿œç¨‹ç™»å½•</li>
<li>SMTPï¼ˆ25ï¼‰ï¼šå‘é€é‚®ä»¶</li>
</ul>
<p><strong>ä¼ è¾“å±‚</strong>ï¼š</p>
<ul>
<li>TCPï¼šå¯é ä¼ è¾“</li>
<li>UDPï¼šå¿«é€Ÿä¼ è¾“</li>
</ul>
<p><strong>ç½‘é™…å±‚</strong>ï¼š</p>
<ul>
<li>IPï¼šå¯»å€å’Œè·¯ç”±</li>
<li>ICMPï¼šé”™è¯¯æŠ¥å‘Šå’Œè¯Šæ–­</li>
</ul>
<p><strong>ç½‘ç»œæ¥å£å±‚</strong>ï¼š</p>
<ul>
<li>Ethernetï¼šæœ‰çº¿ç½‘ç»œ</li>
<li>WiFiï¼šæ— çº¿ç½‘ç»œ</li>
</ul>
<h2 id="ğŸ’ª-ç»ƒä¹ é¢˜"><a href="#ğŸ’ª-ç»ƒä¹ é¢˜" class="headerlink" title="ğŸ’ª ç»ƒä¹ é¢˜"></a>ğŸ’ª ç»ƒä¹ é¢˜</h2><h3 id="ç»ƒä¹ 1ï¼šåè®®è¯†åˆ«"><a href="#ç»ƒä¹ 1ï¼šåè®®è¯†åˆ«" class="headerlink" title="ç»ƒä¹ 1ï¼šåè®®è¯†åˆ«"></a>ç»ƒä¹ 1ï¼šåè®®è¯†åˆ«</h3><p>ä»¥ä¸‹ç«¯å£å·å¯¹åº”ä»€ä¹ˆåè®®ï¼Ÿ</p>
<ol>
<li>80</li>
<li>443</li>
<li>22</li>
<li>3306</li>
<li>27017</li>
</ol>
<h3 id="ç»ƒä¹ 2ï¼šå±‚æ¬¡åˆ¤æ–­"><a href="#ç»ƒä¹ 2ï¼šå±‚æ¬¡åˆ¤æ–­" class="headerlink" title="ç»ƒä¹ 2ï¼šå±‚æ¬¡åˆ¤æ–­"></a>ç»ƒä¹ 2ï¼šå±‚æ¬¡åˆ¤æ–­</h3><p>ä»¥ä¸‹ä¿¡æ¯åˆ†åˆ«å±äºå“ªä¸€å±‚ï¼Ÿ</p>
<ol>
<li>192.168.1.1</li>
<li>AA:BB:CC:DD:EE:FF</li>
<li>ç«¯å£8080</li>
<li>HTTP&#x2F;1.1</li>
<li>TCPåºåˆ—å·12345</li>
</ol>
<h3 id="ç»ƒä¹ 3ï¼šç»˜åˆ¶æ•°æ®åŒ…ç»“æ„"><a href="#ç»ƒä¹ 3ï¼šç»˜åˆ¶æ•°æ®åŒ…ç»“æ„" class="headerlink" title="ç»ƒä¹ 3ï¼šç»˜åˆ¶æ•°æ®åŒ…ç»“æ„"></a>ç»ƒä¹ 3ï¼šç»˜åˆ¶æ•°æ®åŒ…ç»“æ„</h3><p>ç”»å‡ºä¸€ä¸ªå®Œæ•´çš„HTTPè¯·æ±‚æ•°æ®åŒ…çš„ç»“æ„ï¼Œæ ‡æ³¨æ¯ä¸€å±‚çš„å¤´éƒ¨ã€‚</p>
<h3 id="ç»ƒä¹ 4ï¼šä»£ç æ‰©å±•"><a href="#ç»ƒä¹ 4ï¼šä»£ç æ‰©å±•" class="headerlink" title="ç»ƒä¹ 4ï¼šä»£ç æ‰©å±•"></a>ç»ƒä¹ 4ï¼šä»£ç æ‰©å±•</h3><p>æ‰©å±•æ•°æ®åŒ…åˆ†æå™¨ï¼š</p>
<ol>
<li>æ·»åŠ æ•°æ®åŒ…è¿‡æ»¤åŠŸèƒ½ï¼ˆåªæ˜¾ç¤ºç‰¹å®šåè®®ï¼‰</li>
<li>ç»Ÿè®¡å„åè®®çš„æ•°æ®åŒ…æ•°é‡</li>
<li>å°†æ•è·çš„æ•°æ®åŒ…ä¿å­˜åˆ°æ–‡ä»¶</li>
</ol>
<h3 id="ç»ƒä¹ 5ï¼šæ€è€ƒé¢˜"><a href="#ç»ƒä¹ 5ï¼šæ€è€ƒé¢˜" class="headerlink" title="ç»ƒä¹ 5ï¼šæ€è€ƒé¢˜"></a>ç»ƒä¹ 5ï¼šæ€è€ƒé¢˜</h3><ol>
<li>ä¸ºä»€ä¹ˆTCP&#x2F;IPæ¨¡å‹åªæœ‰4å±‚è€ŒOSIæœ‰7å±‚ï¼Ÿ</li>
<li>è·¯ç”±å™¨å·¥ä½œåœ¨å“ªä¸€å±‚ï¼Ÿäº¤æ¢æœºå‘¢ï¼Ÿ</li>
<li>é˜²ç«å¢™å¯èƒ½å·¥ä½œåœ¨å“ªå‡ å±‚ï¼Ÿ</li>
</ol>
<h2 id="ğŸ“š-æ‰©å±•é˜…è¯»"><a href="#ğŸ“š-æ‰©å±•é˜…è¯»" class="headerlink" title="ğŸ“š æ‰©å±•é˜…è¯»"></a>ğŸ“š æ‰©å±•é˜…è¯»</h2><h3 id="TCP-IPåè®®æ—"><a href="#TCP-IPåè®®æ—" class="headerlink" title="TCP&#x2F;IPåè®®æ—"></a>TCP&#x2F;IPåè®®æ—</h3><p>TCP&#x2F;IPä¸ä»…ä»…æ˜¯TCPå’ŒIPä¸¤ä¸ªåè®®ï¼Œè€Œæ˜¯ä¸€æ•´ä¸ªåè®®æ—ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼š</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚ HTTP  FTP   DNS   SMTP  SSH  ç­‰... â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br><span class="line">ä¼ è¾“å±‚ï¼š</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   TCP    â”‚   UDP    â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br><span class="line">ç½‘é™…å±‚ï¼š</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚   IP   ICMP   ARP   IGMP   â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br><span class="line"></span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼š</span><br><span class="line">â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”</span><br><span class="line">â”‚  Ethernet  WiFi  PPP  ç­‰... â”‚</span><br><span class="line">â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</span><br></pre></td></tr></table></figure>

<h3 id="å¸¸è§ç«¯å£å·è®°å¿†"><a href="#å¸¸è§ç«¯å£å·è®°å¿†" class="headerlink" title="å¸¸è§ç«¯å£å·è®°å¿†"></a>å¸¸è§ç«¯å£å·è®°å¿†</h3><p><strong>HTTPå®¶æ—</strong>ï¼š</p>
<ul>
<li>80ï¼šHTTP</li>
<li>443ï¼šHTTPS</li>
<li>8080ï¼šHTTPä»£ç†</li>
</ul>
<p><strong>æ–‡ä»¶ä¼ è¾“</strong>ï¼š</p>
<ul>
<li>20&#x2F;21ï¼šFTP</li>
<li>22ï¼šSFTPï¼ˆSSHï¼‰</li>
<li>69ï¼šTFTP</li>
</ul>
<p><strong>é‚®ä»¶</strong>ï¼š</p>
<ul>
<li>25ï¼šSMTPï¼ˆå‘é€ï¼‰</li>
<li>110ï¼šPOP3ï¼ˆæ¥æ”¶ï¼‰</li>
<li>143ï¼šIMAPï¼ˆæ¥æ”¶ï¼‰</li>
</ul>
<p><strong>æ•°æ®åº“</strong>ï¼š</p>
<ul>
<li>3306ï¼šMySQL</li>
<li>5432ï¼šPostgreSQL</li>
<li>27017ï¼šMongoDB</li>
<li>6379ï¼šRedis</li>
</ul>
<p><strong>è¿œç¨‹</strong>ï¼š</p>
<ul>
<li>22ï¼šSSH</li>
<li>23ï¼šTelnet</li>
<li>3389ï¼šRDPï¼ˆWindowsè¿œç¨‹æ¡Œé¢ï¼‰</li>
</ul>
<h3 id="å®é™…åº”ç”¨åœºæ™¯"><a href="#å®é™…åº”ç”¨åœºæ™¯" class="headerlink" title="å®é™…åº”ç”¨åœºæ™¯"></a>å®é™…åº”ç”¨åœºæ™¯</h3><ol>
<li><p><strong>æµè§ˆç½‘é¡µ</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼šHTTPè¯·æ±‚ www.baidu.com</span><br><span class="line">ä¼ è¾“å±‚ï¼šTCP ç«¯å£80</span><br><span class="line">ç½‘é™…å±‚ï¼šIPåœ°å€ 220.181.38.148</span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼šé€šè¿‡ä»¥å¤ªç½‘å‘é€</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>å‘é€é‚®ä»¶</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼šSMTPåè®®</span><br><span class="line">ä¼ è¾“å±‚ï¼šTCP ç«¯å£25</span><br><span class="line">ç½‘é™…å±‚ï¼šIPåœ°å€ï¼ˆé‚®ä»¶æœåŠ¡å™¨ï¼‰</span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼šWiFi</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>pingå‘½ä»¤</strong>ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åº”ç”¨å±‚ï¼šæ— ï¼ˆICMPæ˜¯ç½‘é™…å±‚åè®®ï¼‰</span><br><span class="line">ä¼ è¾“å±‚ï¼šæ— </span><br><span class="line">ç½‘é™…å±‚ï¼šICMP echo request</span><br><span class="line">ç½‘ç»œæ¥å£å±‚ï¼šä»¥å¤ªç½‘</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="ğŸ¯-æ˜å¤©é¢„å‘Š"><a href="#ğŸ¯-æ˜å¤©é¢„å‘Š" class="headerlink" title="ğŸ¯ æ˜å¤©é¢„å‘Š"></a>ğŸ¯ æ˜å¤©é¢„å‘Š</h2><p><strong>ç¬¬5å¤©ï¼šç½‘ç»œå‘½ä»¤å…¥é—¨ - ping</strong></p>
<p>æˆ‘ä»¬å°†å­¦ä¹ ï¼š</p>
<ul>
<li>pingå‘½ä»¤çš„å·¥ä½œåŸç†</li>
<li>ICMPåè®®è¯¦è§£</li>
<li>RTTï¼ˆå¾€è¿”æ—¶é—´ï¼‰çš„è®¡ç®—</li>
<li>ç¼–å†™è‡ªå·±çš„pingå·¥å…·</li>
</ul>
<hr>
<p>ğŸ’¡ <strong>ä»Šæ—¥é‡‘å¥</strong>ï¼šæŒæ¡TCP&#x2F;IPï¼Œå°±æŒæ¡äº†äº’è”ç½‘çš„è¯­è¨€ï¼</p>
<p>ğŸ‘‰ <a href="day03.md">ä¸Šä¸€å¤©ï¼šOSIä¸ƒå±‚æ¨¡å‹</a> | <a href="../../README.md">è¿”å›ç›®å½•</a> | <a href="day05.md">ä¸‹ä¸€å¤©ï¼špingå‘½ä»¤è¯¦è§£</a></p>
</div

        </article>
        
        <script src="https://giscus.app/client.js"
          data-repo=  https://github.com/bruceox/bruceox.github.io.git
          data-repo-id="MDEwOlJlcG9zaXRvcnkzNTIwMzg4MTk="
          data-category="General"
          data-category-id="DIC_kwDOFPuvo84COOf2"
          data-mapping="pathname"
          data-reactions-enabled="1"
          data-emit-metadata="0"
          data-input-position="top"
          data-theme="light"
          data-lang="en"
          data-loading="lazy"
          crossorigin="anonymous"
          async>
        </script>
        
        <!-- <p class="footer">Made with â™¥ï¸ by Bruce</p> -->
      </main>
  </body>
</html>
